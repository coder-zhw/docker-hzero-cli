(window["webpackJsonppackages_hzero_front_hwfp_name_"]=window["webpackJsonppackages_hzero_front_hwfp_name_"]||[]).push([[69,117,122],Array(37).concat([function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});n(193);var o=n(164),a=n(147),i=n(148),r=n(150),s=n(149),c=n(151),l=n(1),p=n.n(l),u=n(325),d=n(146),f=n(251),h=n(142),m=n(144),v=function(e){function t(){return Object(a["a"])(this,t),Object(r["a"])(this,Object(s["a"])(t).apply(this,arguments))}return Object(c["a"])(t,e),Object(i["a"])(t,[{key:"render",value:function(){var e=this.props.detail,t=void 0===e?{}:e,n=[{title:d["a"].get("hwfp.common.model.approval.time").d("\u5ba1\u6279\u65f6\u95f4"),dataIndex:"endTime",width:180,render:f["b"]},{title:d["a"].get("hwfp.common.model.approval.action").d("\u5ba1\u6279\u52a8\u4f5c"),dataIndex:"action",width:120,render:f["a"]},{title:d["a"].get("hwfp.common.model.approval.step").d("\u5ba1\u6279\u73af\u8282"),dataIndex:"name",width:150},{title:d["a"].get("hwfp.common.model.approval.owner").d("\u5ba1\u6279\u4eba"),dataIndex:"assigneeName",width:150},{title:d["a"].get("hwfp.common.model.approval.opinion").d("\u5ba1\u6279\u610f\u89c1"),dataIndex:"comment"},{title:d["a"].get("hwfp.common.model.approval.file").d("\u9644\u4ef6"),dataIndex:"attachmentUuid",fixed:"right",width:150,render:function(e,t){if(t.attachmentUuid)return p.a.createElement(u["a"],{attachmentUUID:e,bucketName:m["c"],bucketDirectory:"hwfp01",viewOnly:!0})}}];return p.a.createElement(o["default"],{bordered:!0,rowKey:"id",pagination:!1,dataSource:t.historicTaskList,columns:n,scroll:{x:Object(h["B"])(n)}})}}]),t}(l["PureComponent"])},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(0)(198)},,,,,,,,,function(e,t,n){e.exports=n(127)(2563)},function(e,t,n){e.exports=n(0)(1169)},function(e,t,n){"use strict";function o(e,t,n,o,a){var i={};return Object.keys(o).forEach(function(e){i[e]=o[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},i),a&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(a):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n.d(t,"a",function(){return o})},,,,function(e,t,n){e.exports=n(0)(116)},,function(e,t,n){e.exports=n(0)(1154)},function(e,t,n){e.exports=n(0)(111)},function(e,t,n){e.exports=n(0)(82)},function(e,t,n){"use strict";n(143),n(182),n(153)},function(e,t,n){e.exports=n(0)(1161)},function(e,t,n){e.exports=n(0)(1168)},function(e,t,n){e.exports=n(0)(37)},function(e,t,n){e.exports=n(0)(1155)},function(e,t,n){e.exports=n(0)(1852)},function(e,t,n){e.exports=n(0)(829)},,,,function(e,t,n){e.exports=n(127)(2648)},function(e,t,n){e.exports=n(0)(34)},,function(e,t,n){e.exports=n(0)(274)},function(e,t,n){e.exports=n(0)(1167)},,,function(e,t,n){e.exports=n(0)(604)},function(e,t,n){e.exports=n(0)(130)},function(e,t,n){e.exports={"ant-modal":"ant-modal","ant-modal-wrap":"ant-modal-wrap","ant-modal-title":"ant-modal-title","ant-modal-content":"ant-modal-content","ant-modal-close":"ant-modal-close","ant-modal-close-x":"ant-modal-close-x","ant-modal-header":"ant-modal-header","ant-modal-body":"ant-modal-body","ant-modal-footer":"ant-modal-footer","zoom-enter":"zoom-enter","zoom-appear":"zoom-appear","ant-modal-mask":"ant-modal-mask","ant-modal-mask-hidden":"ant-modal-mask-hidden","ant-modal-open":"ant-modal-open","vertical-center-modal":"vertical-center-modal","ant-confirm":"ant-confirm","ant-confirm-body-wrapper":"ant-confirm-body-wrapper","ant-confirm-body":"ant-confirm-body","ant-confirm-title":"ant-confirm-title","ant-confirm-content":"ant-confirm-content",anticon:"anticon","ant-confirm-btns":"ant-confirm-btns","ant-confirm-error":"ant-confirm-error","ant-confirm-warning":"ant-confirm-warning","ant-confirm-confirm":"ant-confirm-confirm","ant-confirm-info":"ant-confirm-info","ant-confirm-success":"ant-confirm-success"}},,function(e,t,n){e.exports=n(0)(182)},function(e,t,n){e.exports=n(0)(661)},,,,,,function(e,t,n){e.exports=n(0)(418)},,,,function(e,t,n){e.exports=n(0)(849)},function(e,t,n){e.exports=n(0)(328)},function(e,t,n){e.exports=n(0)(270)},function(e,t,n){e.exports=n(0)(170)},function(e,t,n){e.exports=n(0)(324)},function(e,t,n){e.exports=n(0)(386)},function(e,t,n){e.exports=n(0)(387)},,,function(e,t,n){e.exports=n(0)(868)},function(e,t,n){e.exports=n(0)(2092)},function(e,t,n){e.exports=n(0)(1858)},function(e,t,n){e.exports=n(0)(325)},function(e,t,n){e.exports=n(0)(209)},function(e,t,n){e.exports=n(127)(2662)},function(e,t,n){e.exports=n(0)(241)},function(e,t,n){e.exports=n(0)(235)},function(e,t,n){e.exports=n(0)(151)},function(e,t,n){e.exports=n(127)(1367)},function(e,t,n){e.exports=n(0)(582)},function(e,t,n){e.exports=n(0)(127)},function(e,t,n){e.exports=n(0)(484)},function(e,t,n){e.exports=n(0)(2129)},function(e,t,n){e.exports=n(0)(385)},function(e,t,n){e.exports=n(0)(156)},function(e,t,n){e.exports=n(0)(255)},function(e,t,n){e.exports=n(0)(1960)},function(e,t,n){e.exports=n(0)(298)},function(e,t,n){e.exports=n(0)(1132)},function(e,t,n){e.exports=n(0)(580)},function(e,t,n){e.exports=n(0)(128)},function(e,t,n){e.exports=n(0)(108)},function(e,t,n){e.exports=n(0)(472)},function(e,t,n){e.exports=n(0)(873)},function(e,t,n){e.exports=n(0)(2130)},,,,function(e,t,n){e.exports=n(0)(61)},,,,,,,,,,function(e,t,n){e.exports=n(0)(1974)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var o=n(176),a=n(307);function i(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],s=e.length;t=o(t,3);while(++i<s){var c=e[i];t(c,i,e)&&(n.push(c),r.push(i))}return a(e,r),n}e.exports=i},function(e,t,n){var o=n(308),a=n(309),i=Array.prototype,r=i.splice;function s(e,t){var n=e?t.length:0,i=n-1;while(n--){var s=t[n];if(n==i||s!==c){var c=s;a(s)?r.call(e,s,1):o(e,s)}}return e}e.exports=s},function(e,t,n){e.exports=n(0)(2121)},function(e,t,n){e.exports=n(0)(242)},,,,function(e,t,n){"use strict";n(143),n(314),n(316),n(177)},function(e,t,n){e.exports={"ant-upload":"ant-upload","ant-upload-btn":"ant-upload-btn","ant-upload-select":"ant-upload-select","ant-upload-select-picture-card":"ant-upload-select-picture-card","ant-upload-drag":"ant-upload-drag","ant-upload-drag-hover":"ant-upload-drag-hover","ant-upload-disabled":"ant-upload-disabled","ant-upload-drag-container":"ant-upload-drag-container","ant-upload-drag-icon":"ant-upload-drag-icon",anticon:"anticon","ant-upload-text":"ant-upload-text","ant-upload-hint":"ant-upload-hint","anticon-plus":"anticon-plus","ant-upload-list":"ant-upload-list","ant-upload-list-item":"ant-upload-list-item","ant-upload-list-item-name":"ant-upload-list-item-name","ant-upload-list-item-info":"ant-upload-list-item-info","anticon-loading":"anticon-loading","anticon-paper-clip":"anticon-paper-clip","anticon-cross":"anticon-cross","ant-upload-list-item-error":"ant-upload-list-item-error","ant-upload-list-item-progress":"ant-upload-list-item-progress","ant-upload-list-picture":"ant-upload-list-picture","ant-upload-list-picture-card":"ant-upload-list-picture-card","ant-upload-list-item-file-name":"ant-upload-list-item-file-name","ant-upload-list-item-uploading":"ant-upload-list-item-uploading","ant-upload-list-item-thumbnail":"ant-upload-list-item-thumbnail","ant-upload-list-item-icon":"ant-upload-list-item-icon","ant-upload-list-item-action-remove":"ant-upload-list-item-action-remove","ant-upload-list-item-picture-card":"ant-upload-list-item-picture-card","ant-upload-list-item-actions":"ant-upload-list-item-actions","anticon-eye-o":"anticon-eye-o","anticon-download":"anticon-download","anticon-upload":"anticon-upload","anticon-picture":"anticon-picture","ant-upload-list-item-uploading-text":"ant-upload-list-item-uploading-text","ant-upload-success-icon":"ant-upload-success-icon","ant-upload-animate-enter":"ant-upload-animate-enter","ant-upload-animate-leave":"ant-upload-animate-leave","ant-upload-animate-inline-enter":"ant-upload-animate-inline-enter","ant-upload-animate-inline-leave":"ant-upload-animate-inline-leave",uploadAnimateIn:"uploadAnimateIn",uploadAnimateOut:"uploadAnimateOut",uploadAnimateInlineIn:"uploadAnimateInlineIn",uploadAnimateInlineOut:"uploadAnimateInlineOut"}},,function(e,t,n){e.exports=n(0)(2098)},function(e,t,n){e.exports=n(0)(1208)},,,,,,,function(e,t,n){var o=n(205);function a(e,t){return t="function"==typeof t?t:void 0,e&&e.length?o(e,void 0,t):[]}e.exports=a},function(e,t,n){"use strict";n(163);var o,a,i,r,s,c,l,p=n(160),u=(n(241),n(191)),d=(n(143),n(329),n(331)),f=(n(269),n(185)),h=(n(153),n(161)),m=(n(165),n(166)),v=n(172),b=n(2),y=n.n(b),g=n(29),w=n(28),O=n(147),x=n(148),j=n(150),I=n(149),C=n(151),k=n(154),E=n(158),S=n.n(E),U=n(175),D=n.n(U),T=n(1),P=n.n(T),A=n(152),z=n(332),M=n.n(z),L=(n(334),n(146)),N=n(144),_=n(142),R=n(171),H=(n(313),n(317)),X=n(318),Y=n(231),F=(n(238),n(167)),W=n(324),B=n.n(W),V=n(306),Z=n.n(V),K=n(180),G=n.n(K),J=n(30),q=n.n(J),Q=n(233),$=n.n(Q),ee=n(336),te=n.n(ee),ne=n(145);F["default"].config({placement:"bottomRight"});var oe,ae,ie,re,se,ce,le,pe,ue,de,fe,he=(o=Object(A["Bind"])(),a=Object(A["Bind"])(),i=Object(A["Bind"])(),r=Object(A["Bind"])(),s=Object(A["Bind"])(),c=Object(A["Bind"])(),l=function(e){function t(e){var n;Object(O["a"])(this,t),n=Object(j["a"])(this,Object(I["a"])(t).call(this,e));var o=n.props.onRef;return o&&o(Object(Y["a"])(n)),n.state={fileList:null},n}return Object(C["a"])(t,e),Object(x["a"])(t,[{key:"setFileList",value:function(e){e&&this.setState({fileList:e})}},{key:"uploadData",value:function(e){var t=this.props,n=t.attachmentUUID,o=t.bucketName,a=t.uploadData,i=t.bucketDirectory,r=t.docType,s=t.storageCode,c=a?a(e):{};if(!(c instanceof FormData)){var l=c;c=new FormData,$()(c)&&Object.keys(l).forEach(function(e){c.append(e,l[e])})}return G()(n)||c.append("attachmentUUID",n),G()(o)||c.append("bucketName",o),G()(r)||c.append("docType",r),G()(s)||c.append("storageCode",s),G()(i)||c.append("directory",i),c}},{key:"onChange",value:function(e){var t=e.file,n=e.fileList,o=this.props,a=o.single,i=void 0!==a&&a,r=o.tenantId,s=o.bucketName,c=o.bucketDirectory,l=Object(X["a"])(n);if("done"===t.status){var p=t.response;if(p&&!0===p.failed)this.onUploadError(t,n);else{if(i){if(n.length>1){var u=this.props.onRemove;Promise.all(n.slice(0,n.length-1).map(function(){var e=Object(w["a"])(y.a.mark(function e(t){var n,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.url){e.next=20;break}if(!u){e.next=11;break}return e.prev=2,e.next=5,u(t);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](2);case 9:e.next=20;break;case 11:return n=t.url&&t.url.split("=")||[],o=n[n.length-1],e.prev=13,e.next=16,Object(R["l"])({tenantId:r,bucketName:s,urls:[o]});case 16:e.next=20;break;case 18:e.prev=18,e.t1=e["catch"](13);case 20:case"end":return e.stop()}},e,null,[[2,7],[13,18]])}));return function(t){return e.apply(this,arguments)}}())).catch(function(){})}l=[{uid:t.uid,name:t.name,url:Object(_["e"])(t.response,s,r,c),thumbUrl:Object(_["e"])(t.response,s,r,c)}]}else l=n.map(function(e){return e.uid===t.uid&&(e.url=Object(_["e"])(e.response,s,r,c)),e});this.onUploadSuccess(t,l)}}else"error"===t.status&&(this.onUploadError(t,n),l=n.filter(function(e){return"error"!==e.status&&e.uid}));this.setState({fileList:B()(l,function(e,t){return e.uid===t.uid})})}},{key:"beforeUpload",value:function(e){var t=this.props,n=t.fileType,o=t.fileSize,a=void 0===o?31457280:o;if(n&&-1===n.indexOf(e.type)){e.status="error";var i={message:L["a"].get("hzero.common.upload.error.type",{fileType:n}).d("\u4e0a\u4f20\u6587\u4ef6\u7c7b\u578b\u5fc5\u987b\u662f\uff1a".concat(n))};return e.response=i,!1}if(e.size>a){e.status="error";var r={message:L["a"].get("hzero.common.upload.error.size",{fileSize:a/1048576}).d("\u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc7: ".concat(a/1048576," MB"))};return e.response=r,!1}return!0}},{key:"onRemove",value:function(e){var t=this,n=this.props,o=n.onRemove,a=n.bucketName,i=n.onRemoveSuccess,r=n.single,s=void 0!==r&&r,c=n.tenantId,l=this.state.fileList;if(e.url){if(o)return o(e);var p=e.url&&e.url.split("=")||[],u=p[p.length-1];return Object(R["l"])({tenantId:c,bucketName:a,urls:[u]}).then(function(n){return!!Object(_["m"])(n)&&(i&&i(),s?t.setState({fileList:[]}):(Z()(l,function(t){return t.uid===e.uid}),t.setState({fileList:l})),!0)})}this.setState({fileList:l.filter(function(t){return t.uid!==e.uid})})}},{key:"onUploadSuccess",value:function(e,t){var n=this.props.onUploadSuccess;n&&n(e,t)}},{key:"onUploadError",value:function(e,t){var n=this.props.onUploadError,o=!0;n&&(o=!1!==n(e,t)),o&&F["default"].error({message:L["a"].get("hzero.common.upload.status.error").d("\u4e0a\u4f20\u5931\u8d25"),description:e.response&&e.response.message})}},{key:"changeFileList",value:function(e){var t=this.props,n=t.bucketName,o=t.bucketDirectory,a=t.tenantId;if(e)return e.map(function(e){return Object(g["a"])({},e,{url:Object(_["e"])(e.url,n,a,o)})})}},{key:"handleAction",value:function(e){var t=e.file,n=e.onProgress,o=e.onSuccess,a=e.onError,i=new te.a,r=i.signal,s=this.props.action,c=s||(Object(_["t"])()?"".concat(N["d"],"/v1/").concat(Object(_["g"])(),"/files/multipart"):"".concat(N["d"],"/v1/files/multipart")),l="".concat(c),p=this.uploadData(t);return p.append("file",t,t.name),Object(ne["a"])(l,{processData:!1,method:"POST",type:"FORM",body:p,responseType:"text",signal:r,onProgress:n?function(e){return n(e,t)}:null},{beforeCatch:function(e){if("AbortError"!==e.name)throw new Error(e)}}).then(function(e){q()(e)?o(e):Object(_["m"])(e)||a(e)}),{abort:function(){i.abort()}}}},{key:"render",value:function(){var e=this.props,t=e.fileList,n=e.fileType,o=(e.fileSize,e.single,e.text),a=void 0===o?L["a"].get("hzero.common.upload.txt").d("\u4e0a\u4f20"):o,i=e.listType,r=void 0===i?"picture":i,s=(e.bucketName,e.onUploadSuccess,e.onUploadError,e.viewOnly),c=void 0!==s&&s,l=e.showRemoveIcon,p=void 0===l||l,u=(e.docType,e.storageCode,e.children),d=Object(v["a"])(e,["fileList","fileType","fileSize","single","text","listType","bucketName","onUploadSuccess","onUploadError","viewOnly","showRemoveIcon","docType","storageCode","children"]),f=Object(_["d"])(),b=this.changeFileList(t),y={};f&&(y.Authorization="bearer ".concat(f));var g,w=n&&-1===n.indexOf(",")?n.split(";").join(","):n;return g="picture-card"===r?P.a.createElement("div",null,P.a.createElement(m["default"],{style:{fontSize:"32px",color:"#999"},type:"plus"})):P.a.createElement(h["default"],null,P.a.createElement(m["default"],{type:"upload"})," ",a),P.a.createElement(H["default"],Object.assign({name:"file",accept:w,fileList:this.state.fileList||b,data:this.uploadData,customRequest:this.handleAction,headers:y,onChange:this.onChange,listType:r,beforeUpload:this.beforeUpload,onRemove:this.onRemove,showUploadList:{showRemoveIcon:!c&&p}},d),u||!c&&g)}}]),t}(P.a.Component),Object(k["a"])(l.prototype,"uploadData",[o],Object.getOwnPropertyDescriptor(l.prototype,"uploadData"),l.prototype),Object(k["a"])(l.prototype,"onChange",[a],Object.getOwnPropertyDescriptor(l.prototype,"onChange"),l.prototype),Object(k["a"])(l.prototype,"beforeUpload",[i],Object.getOwnPropertyDescriptor(l.prototype,"beforeUpload"),l.prototype),Object(k["a"])(l.prototype,"onRemove",[r],Object.getOwnPropertyDescriptor(l.prototype,"onRemove"),l.prototype),Object(k["a"])(l.prototype,"changeFileList",[s],Object.getOwnPropertyDescriptor(l.prototype,"changeFileList"),l.prototype),Object(k["a"])(l.prototype,"handleAction",[c],Object.getOwnPropertyDescriptor(l.prototype,"handleAction"),l.prototype),l);n.d(t,"a",function(){return ve});var me="spfm-comp",ve=(oe=Object(A["Bind"])(),ae=Object(A["Bind"])(),ie=Object(A["Bind"])(),re=Object(A["Bind"])(),se=Object(A["Bind"])(),ce=Object(A["Bind"])(),le=Object(A["Bind"])(),pe=Object(A["Bind"])(),ue=Object(A["Bind"])(),fe=function(e){function t(e){var n;return Object(O["a"])(this,t),n=Object(j["a"])(this,Object(I["a"])(t).call(this,e)),n.upload=void 0,n.state={visible:!1,loading:!1,modalLoading:!1,templateList:[],fileList:[],previewVisible:!1,previewImages:[],attachmentUUID:""},n}return Object(C["a"])(t,e),Object(x["a"])(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.bucketName,o=void 0===n?me:n,a=t.attachmentUUID,i=t.tenantId;a&&Object(R["b"])({tenantId:i,bucketName:o,attachmentUUID:a}).then(function(t){Object(_["m"])(t)&&e.setState({fileList:e.changeFileList(t)})})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,n=this.props,o=n.bucketName,a=void 0===o?me:o,i=n.tenantId;this.props.attachmentUUID!==e.attachmentUUID&&Object(R["b"])({tenantId:i,bucketName:a,attachmentUUID:e.attachmentUUID}).then(function(e){Object(_["m"])(e)&&t.setState({fileList:t.changeFileList(e)})})}},{key:"changeFileList",value:function(e){var t=this.props,n=t.bucketName,o=void 0===n?me:n,a=t.bucketDirectory,i=t.tenantId;return e.map(function(e,t){return{uid:t+1,name:e.fileName,status:"done",url:Object(_["e"])(e.fileUrl,o,i,a)}})}},{key:"handleAfterOpenModal",value:function(){var e=this.props,t=e.afterOpenUploadModal,n=e.attachmentUUID,o=this.state.attachmentUUID;S()(t)&&t(n||o)}},{key:"closeUploadModal",value:function(){var e=this.props.onCloseUploadModal;this.setState({visible:!1}),e&&e()}},{key:"openUploadModal",value:function(){var e=Object(w["a"])(y.a.mark(function e(){var t,n,o,a,i,r,s,c,l,p,u,d,f=this;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.props,n=t.bucketName,o=void 0===n?me:n,a=t.attachmentUUID,i=t.templateAttachmentUUID,r=t.tenantId,s=this.state.attachmentUUID,this.setState({visible:!0,loading:!0}),c={loading:!1},!i){e.next=9;break}return e.next=7,Object(R["b"])({tenantId:r,bucketName:o,attachmentUUID:i});case 7:l=e.sent,Object(_["m"])(l)&&(c=Object(g["a"])({},c,{templateList:l}));case 9:if(p=a||s,p){e.next=15;break}return e.next=13,Object(R["i"])({tenantId:r});case 13:u=e.sent,u&&(p=u.content);case 15:if(c=Object(g["a"])({},c,{attachmentUUID:p}),!p){e.next=22;break}return e.next=19,Object(R["b"])({tenantId:r,bucketName:o,attachmentUUID:p});case 19:d=e.sent,Object(_["m"])(d)&&(c=Object(g["a"])({},c,{fileList:this.changeFileList(d)}),this.upload&&this.upload.setFileList(this.changeFileList(d))),this.setState(c,function(){f.handleAfterOpenModal()});case 22:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"onRef",value:function(e){this.upload=e}},{key:"onUploadSuccess",value:function(e,t){var n=this.props.uploadSuccess;n&&n(),this.setState({fileList:t});var o=this.props.onChange;if(o){var a=this.props.single;if(a);else{var i=this.props.attachmentUUID,r=this.state.attachmentUUID;o(i||r)}}}},{key:"handlePreview",value:function(e){this.setState({previewImages:[{src:e.url||e.thumbUrl,alt:""}],previewVisible:!0})}},{key:"handlePreviewCancel",value:function(){this.setState({previewImages:[],previewVisible:!1})}},{key:"removeFile",value:function(e){var t=this,n=this.props,o=n.removeCallback,a=n.bucketName,i=void 0===a?me:a,r=n.tenantId,s=n.attachmentUUID,c=this.state,l=c.attachmentUUID,p=c.fileList;if(this.setState({modalLoading:!0}),e.url){var u=e.url&&e.url.split("=")||[],d=u[u.length-1];return Object(R["k"])({tenantId:r,bucketName:i,attachmentUUID:s||l,urls:[d]}).then(function(n){return Object(_["m"])(n)?(t.setState({modalLoading:!1,fileList:p.filter(function(t){return t.url!==e.url})}),o&&o(),!0):(t.setState({modalLoading:!1}),!1)})}this.setState({modalLoading:!1,fileList:p.filter(function(t){return t.uid!==e.uid})})}},{key:"render",value:function(){var e=this.props,t=e.bucketName,n=void 0===t?me:t,o=e.bucketDirectory,a=e.viewOnly,i=void 0!==a&&a,r=e.icon,s=void 0===r?i?"paper-clip":"upload":r,c=e.filesNumber,l=void 0===c?"":c,b=e.showFilesNumber,y=void 0===b||b,g=e.hasTemplate,w=e.multiple,O=void 0===w||w,x=e.btnText,j=void 0===x?i?L["a"].get("hzero.common.upload.view").d("\u67e5\u770b\u9644\u4ef6"):L["a"].get("hzero.common.upload.text").d("\u4e0a\u4f20\u9644\u4ef6"):x,I=e.description,C=(e.onChange,e.tenantId),k=e.btnProps,E=void 0===k?{}:k,S=e.title,U=void 0===S?L["a"].get("hzero.common.upload.modal.title").d("\u9644\u4ef6"):S,T=(e.docType,e.storageCode,Object(v["a"])(e,["bucketName","bucketDirectory","viewOnly","icon","filesNumber","showFilesNumber","hasTemplate","multiple","btnText","description","onChange","tenantId","btnProps","title","docType","storageCode"])),A=this.props.attachmentUUID,z=this.state,R=z.visible,H=z.modalLoading,X=z.previewVisible,Y=z.previewImages,F=z.fileList,W=z.templateList,B=void 0===W?[]:W,V=z.loading,Z=void 0!==V&&V,K=z.attachmentUUID,G=Object(_["t"])()?"".concat(N["d"],"/v1/").concat(Object(_["g"])(),"/files/attachment/multipart"):"".concat(N["d"],"/v1/files/attachment/multipart"),J="".concat(G),q=P.a.createElement(P.a.Fragment,null,D()(E)?P.a.createElement("a",{onClick:this.openUploadModal},s&&P.a.createElement(m["default"],{type:s}),j):P.a.createElement(h["default"],Object.assign({onClick:this.openUploadModal},E),j),y&&(l&&0!==l||F.length>0)&&P.a.createElement(f["default"],{color:"#108ee9",style:{height:"auto",lineHeight:"15px",marginLeft:"4px"}},l&&0!==l?l:F.length)),Q=null;if(g||I){var $=B.map(function(e){return P.a.createElement(f["default"],null,P.a.createElement("a",{style:{color:"#108ee9"},href:e.fileUrl,target:"_blank",rel:"noopener noreferrer"},e.fileName))}),ee=P.a.createElement(P.a.Fragment,null,P.a.createElement("div",null,I),P.a.createElement("div",null,g&&P.a.createElement("span",null,L["a"].get("hzero.common.upload.template").d("\u9644\u4ef6\u6a21\u677f"),": ",$)));Q=P.a.createElement(d["default"],{showIcon:!0,message:ee,style:{marginRight:"8px",marginBottom:"15px"},type:"info"})}var te=P.a.createElement(P.a.Fragment,null,Z&&P.a.createElement("div",{style:{textAlign:"center",padding:"30px 50px"}},P.a.createElement(u["default"],null)),P.a.createElement("div",{style:{display:Z?"none":""}},Q,P.a.createElement(u["default"],{spinning:H},P.a.createElement(he,Object.assign({viewOnly:i,multiple:O,listType:"picture-card",onPreview:this.handlePreview,bucketName:n,bucketDirectory:o,onRef:this.onRef,tenantId:C,onRemove:this.removeFile,onUploadSuccess:this.onUploadSuccess,showUploadList:{removePopConfirmTitle:L["a"].get("hzero.common.message.confirm.delete").d("\u662f\u5426\u5220\u9664\u6b64\u6761\u8bb0\u5f55\uff1f"),showRemoveIcon:!i},action:J},T,{attachmentUUID:A||K})))));return P.a.createElement(P.a.Fragment,null,q,P.a.createElement(p["default"],{visible:R,title:U,width:610,footer:null,onCancel:this.closeUploadModal},te),P.a.createElement(M.a,{noImgDetails:!0,noNavbar:!0,scalable:!1,changeable:!1,visible:X,onClose:this.handlePreviewCancel,images:Y}))}}]),t}(T["PureComponent"]),de=fe,Object(k["a"])(de.prototype,"changeFileList",[oe],Object.getOwnPropertyDescriptor(de.prototype,"changeFileList"),de.prototype),Object(k["a"])(de.prototype,"handleAfterOpenModal",[ae],Object.getOwnPropertyDescriptor(de.prototype,"handleAfterOpenModal"),de.prototype),Object(k["a"])(de.prototype,"closeUploadModal",[ie],Object.getOwnPropertyDescriptor(de.prototype,"closeUploadModal"),de.prototype),Object(k["a"])(de.prototype,"openUploadModal",[re],Object.getOwnPropertyDescriptor(de.prototype,"openUploadModal"),de.prototype),Object(k["a"])(de.prototype,"onRef",[se],Object.getOwnPropertyDescriptor(de.prototype,"onRef"),de.prototype),Object(k["a"])(de.prototype,"onUploadSuccess",[ce],Object.getOwnPropertyDescriptor(de.prototype,"onUploadSuccess"),de.prototype),Object(k["a"])(de.prototype,"handlePreview",[le],Object.getOwnPropertyDescriptor(de.prototype,"handlePreview"),de.prototype),Object(k["a"])(de.prototype,"handlePreviewCancel",[pe],Object.getOwnPropertyDescriptor(de.prototype,"handlePreviewCancel"),de.prototype),Object(k["a"])(de.prototype,"removeFile",[ue],Object.getOwnPropertyDescriptor(de.prototype,"removeFile"),de.prototype),de)},,,,function(e,t,n){e.exports={"ant-alert":"ant-alert","ant-alert-no-icon":"ant-alert-no-icon","ant-alert-icon":"ant-alert-icon","ant-alert-description":"ant-alert-description","ant-alert-success":"ant-alert-success","ant-alert-info":"ant-alert-info","ant-alert-warning":"ant-alert-warning","ant-alert-error":"ant-alert-error","ant-alert-close-icon":"ant-alert-close-icon","anticon-cross":"anticon-cross","ant-alert-close-text":"ant-alert-close-text","ant-alert-with-description":"ant-alert-with-description","ant-alert-message":"ant-alert-message","ant-alert-close":"ant-alert-close","ant-alert-slide-up-leave":"ant-alert-slide-up-leave",antAlertSlideUpOut:"antAlertSlideUpOut","ant-alert-banner":"ant-alert-banner",antAlertSlideUpIn:"antAlertSlideUpIn"}},,function(e,t,n){e.exports=n(0)(1129)},function(e,t,n){(function(t,o){e.exports=o(n(1),n(333))})(0,function(e,t){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={exports:{},id:o,loaded:!1};return e[o].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=i(o);function i(e){return e&&e.__esModule?e:{default:e}}t.default=a.default,e.exports=t["default"]},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ActionType=void 0;var o=n(1),a=i(o);function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var a=n[o],i=Object.getOwnPropertyDescriptor(t,a);i&&i.configurable&&void 0===e[a]&&Object.defineProperty(e,a,i)}return e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):r(e,t))}var p=t.ActionType=void 0;(function(e){e[e["zoomIn"]=1]="zoomIn",e[e["zoomOut"]=2]="zoomOut",e[e["prev"]=3]="prev",e[e["next"]=4]="next",e[e["rotateLeft"]=5]="rotateLeft",e[e["rotateRight"]=6]="rotateRight",e[e["reset"]=7]="reset",e[e["close"]=8]="close",e[e["scaleX"]=9]="scaleX",e[e["scaleY"]=10]="scaleY",e[e["download"]=11]="download"})(p||(t.ActionType=p={}));var u=function(e){function t(){return s(this,t),c(this,e.apply(this,arguments))}return l(t,e),t.prototype.render=function(){var e="react-viewer-icon";return a.createElement("i",{className:e+" "+e+"-"+p[this.props.type]})},t}(a.Component);t.default=u},function(e,t,n){var o,a;(function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var a=typeof o;if("string"===a||"number"===a)e.push(o);else if(Array.isArray(o)&&o.length){var r=i.apply(null,o);r&&e.push(r)}else if("object"===a)for(var s in o)n.call(o,s)&&o[s]&&e.push(s)}}return e.join(" ")}"undefined"!==typeof e&&e.exports?(i.default=i,e.exports=i):(o=[],a=function(){return i}.apply(t,o),void 0===a||(e.exports=a))})()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(1),a=i(o);function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var a=n[o],i=Object.getOwnPropertyDescriptor(t,a);i&&i.configurable&&void 0===e[a]&&Object.defineProperty(e,a,i)}return e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):r(e,t))}var p=function(e){function t(){return s(this,t),c(this,e.call(this))}return l(t,e),t.prototype.render=function(){var e="circle-loading";return a.createElement("div",{className:"loading-wrap",style:this.props.style},a.createElement("div",{className:e}))},t}(a.Component);t.default=p,e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(1),a=p(o),i=n(12),r=p(i),s=n(7),c=l(s);function l(e){return e&&e.__esModule?e:{default:e}}function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var a=n[o],i=Object.getOwnPropertyDescriptor(t,a);i&&i.configurable&&void 0===e[a]&&Object.defineProperty(e,a,i)}return e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):u(e,t))}var m=function(e){function t(){d(this,t);var n=f(this,e.call(this));return n.container=null,n.defaultContainer=null,"undefined"!==typeof document&&n.setDefaultContainer(),n.component=null,n}return h(t,e),t.prototype.setDefaultContainer=function(){this.defaultContainer=document.createElement("div")},t.prototype.renderViewer=function(){if(this.props.visible||this.component){this.container||(this.props.container?this.container=this.props.container:(this.defaultContainer||this.setDefaultContainer(),this.container=this.defaultContainer,document.body.appendChild(this.container)));var e=this;r.unstable_renderSubtreeIntoContainer(this,a.createElement(c.default,this.props),this.container,function(){e.component=this})}},t.prototype.removeViewer=function(){if(this.container){var e=this.container;r.unmountComponentAtNode(e),e.parentNode.removeChild(e),this.container=null,this.component=null}},t.prototype.componentWillUnmount=function(){this.props.visible&&this.props.onClose&&this.props.onClose(),this.removeViewer()},t.prototype.componentDidMount=function(){this.renderViewer()},t.prototype.componentDidUpdate=function(e){this.props.container!==e.container&&(this.component=null,this.props.container?(this.container&&!e.container&&document.body.removeChild(this.container),this.container=this.props.container):(this.container=this.defaultContainer,document.body.appendChild(this.container))),this.renderViewer()},t.prototype.render=function(){return null},t}(a.Component);t.default=m,e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(1),a=p(o),i=n(4),r=l(i),s=n(3),c=l(s);function l(e){return e&&e.__esModule?e:{default:e}}function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var a=n[o],i=Object.getOwnPropertyDescriptor(t,a);i&&i.configurable&&void 0===e[a]&&Object.defineProperty(e,a,i)}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function m(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):u(e,t))}var v=function(e){function t(){f(this,t);var n=h(this,e.call(this));return n.handleResize=function(e){n.props.onResize()},n.handleCanvasMouseDown=function(e){n.props.onCanvasMouseDown(e),n.handleMouseDown(e)},n.handleMouseDown=function(e){0===e.button&&n.props.visible&&n.props.drag&&(e.preventDefault(),e.stopPropagation(),n.setState({isMouseDown:!0,mouseX:e.nativeEvent.clientX,mouseY:e.nativeEvent.clientY}))},n.handleMouseMove=function(e){if(n.state.isMouseDown){var t=e.clientX-n.state.mouseX,o=e.clientY-n.state.mouseY;n.setState({mouseX:e.clientX,mouseY:e.clientY}),n.props.onChangeImgState(n.props.width,n.props.height,n.props.top+o,n.props.left+t)}},n.handleMouseUp=function(e){n.setState({isMouseDown:!1})},n.bindEvent=function(e){var t="addEventListener";e&&(t="removeEventListener"),document[t]("click",n.handleMouseUp,!1),document[t]("mousemove",n.handleMouseMove,!1),window[t]("resize",n.handleResize,!1)},n.state={isMouseDown:!1,mouseX:0,mouseY:0},n}return m(t,e),t.prototype.componentDidMount=function(){this.props.drag&&this.bindEvent()},t.prototype.componentDidUpdate=function(e){return this.props.visible&&!e.visible&&this.props.drag?this.bindEvent():!this.props.visible&&e.visible&&(this.handleMouseUp({}),this.props.drag)?this.bindEvent(!0):!this.props.drag&&e.drag?this.bindEvent(!0):this.props.drag&&!e.drag&&this.props.visible?this.bindEvent(!0):void 0},t.prototype.componentWillUnmount=function(){this.bindEvent(!0)},t.prototype.render=function(){var e={width:this.props.width+"px",height:this.props.height+"px",transform:"\ntranslateX("+(null!==this.props.left?this.props.left+"px":"aoto")+") translateY("+this.props.top+"px)\n      rotate("+this.props.rotate+"deg) scaleX("+this.props.scaleX+") scaleY("+this.props.scaleY+")"},t=(0,c.default)(this.props.prefixCls+"-image",d({drag:this.props.drag},this.props.prefixCls+"-image-transition",!this.state.isMouseDown)),n={zIndex:this.props.zIndex},o=null;return""!==this.props.imgSrc&&(o=a.createElement("img",{className:t,src:this.props.imgSrc,style:e,onMouseDown:this.handleMouseDown})),this.props.loading&&(o=a.createElement("div",{style:{display:"flex",height:window.innerHeight-84+"px",justifyContent:"center",alignItems:"center"}},a.createElement(r.default,null))),a.createElement("div",{className:this.props.prefixCls+"-canvas",onMouseDown:this.handleCanvasMouseDown,style:n},o)},t}(a.Component);t.default=v,e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){var n=[],o=!0,a=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done);o=!0)if(n.push(r.value),t&&n.length===t)break}catch(c){a=!0,i=c}finally{try{!o&&s["return"]&&s["return"]()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(1),i=g(a);n(11);var r=n(6),s=y(r),c=n(8),l=y(c),p=n(9),u=y(p),d=n(2),f=y(d),h=n(10),m=g(h),v=n(3),b=y(v);function y(e){return e&&e.__esModule?e:{default:e}}function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function w(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var a=n[o],i=Object.getOwnPropertyDescriptor(t,a);i&&i.configurable&&void 0===e[a]&&Object.defineProperty(e,a,i)}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function I(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):w(e,t))}function C(){}var k=300,E=function(e){function t(n){x(this,t);var a=j(this,e.call(this,n));return a.handleClose=function(){a.props.onClose()},a.loadImgSuccess=function(e,t,n,i){var r=t,s=n;a.props.defaultSize&&(r=a.props.defaultSize.width,s=a.props.defaultSize.height),e.defaultSize&&(r=e.defaultSize.width,s=e.defaultSize.height);var c=a.getImgWidthHeight(r,s),l=o(c,2),p=l[0],u=l[1],d=(a.containerWidth-p)/2,f=(a.containerHeight-u-a.footerHeight)/2,h=a.props.defaultScale,m=a.props.defaultScale;a.props.noResetZoomAfterChange&&i&&(h=a.state.scaleX,m=a.state.scaleY),a.setState({width:p,height:u,left:d,top:f,imageWidth:t,imageHeight:n,loading:!1,rotate:0,scaleX:h,scaleY:m})},a.handleChangeImg=function(e){if((a.props.loop||!(e>=a.props.images.length||e<0))&&(e>=a.props.images.length&&(e=0),e<0&&(e=a.props.images.length-1),e!==a.state.activeIndex)){if(a.props.onChange){var t=a.getActiveImage(e);a.props.onChange(t,e)}a.loadImg(e,!0)}},a.handleChangeImgState=function(e,t,n,o){a.setState({width:e,height:t,top:n,left:o})},a.handleDefaultAction=function(e){switch(e){case d.ActionType.prev:a.handleChangeImg(a.state.activeIndex-1);break;case d.ActionType.next:a.handleChangeImg(a.state.activeIndex+1);break;case d.ActionType.zoomIn:var t=a.getImageCenterXY();a.handleZoom(t.x,t.y,1,a.props.zoomSpeed);break;case d.ActionType.zoomOut:var n=a.getImageCenterXY();a.handleZoom(n.x,n.y,-1,a.props.zoomSpeed);break;case d.ActionType.rotateLeft:a.handleRotate();break;case d.ActionType.rotateRight:a.handleRotate(!0);break;case d.ActionType.reset:a.loadImg(a.state.activeIndex);break;case d.ActionType.scaleX:a.handleScaleX(-1);break;case d.ActionType.scaleY:a.handleScaleY(-1);break;case d.ActionType.download:a.handleDownload();break;default:break}},a.handleAction=function(e){if(a.handleDefaultAction(e.actionType),e.onClick){var t=a.getActiveImage();e.onClick(t)}},a.handleDownload=function(){var e=a.getActiveImage();e.downloadUrl&&(location.href=e.downloadUrl)},a.handleScaleX=function(e){a.setState({scaleX:a.state.scaleX*e})},a.handleScaleY=function(e){a.setState({scaleY:a.state.scaleY*e})},a.handleScrollZoom=function(e,t,n){a.handleZoom(e,t,n,a.props.zoomSpeed)},a.handleZoom=function(e,t,n,i){var r=a.getImageCenterXY(),s=e-r.x,c=t-r.y,l=0,p=0,u=0,d=0,f=0,h=0;if(0===a.state.width){var m=a.getImgWidthHeight(a.state.imageWidth,a.state.imageHeight),v=o(m,2),b=v[0],y=v[1];p=(a.containerWidth-b)/2,l=(a.containerHeight-a.footerHeight-y)/2,u=a.state.width+b,d=a.state.height+y,f=h=1}else{var g=a.state.scaleX>0?1:-1,w=a.state.scaleY>0?1:-1;if(f=a.state.scaleX+i*n*g,h=a.state.scaleY+i*n*w,Math.abs(f)<.1||Math.abs(h)<.1)return;l=a.state.top+-n*c/a.state.scaleX*i*g,p=a.state.left+-n*s/a.state.scaleY*i*w,u=a.state.width,d=a.state.height}a.setState({width:u,scaleX:f,scaleY:h,height:d,top:l,left:p,loading:!1})},a.getImageCenterXY=function(){return{x:a.state.left+a.state.width/2,y:a.state.top+a.state.height/2}},a.handleRotate=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a.setState({rotate:a.state.rotate+90*(e?1:-1)})},a.handleResize=function(){if(a.setContainerWidthHeight(),a.props.visible){var e=(a.containerWidth-a.state.width)/2,t=(a.containerHeight-a.state.height-a.footerHeight)/2;a.setState({left:e,top:t})}},a.handleKeydown=function(e){var t=e.keyCode||e.which||e.charCode,n=!1;switch(t){case 27:a.props.onClose(),n=!0;break;case 37:e.ctrlKey?a.handleDefaultAction(d.ActionType.rotateLeft):a.handleDefaultAction(d.ActionType.prev),n=!0;break;case 39:e.ctrlKey?a.handleDefaultAction(d.ActionType.rotateRight):a.handleDefaultAction(d.ActionType.next),n=!0;break;case 38:a.handleDefaultAction(d.ActionType.zoomIn),n=!0;break;case 40:a.handleDefaultAction(d.ActionType.zoomOut),n=!0;break;case 49:e.ctrlKey&&(a.loadImg(a.state.activeIndex),n=!0);break;default:break}n&&(e.preventDefault(),e.stopPropagation())},a.handleTransitionEnd=function(){a.state.transitionEnd&&!a.state.visibleStart||a.setState({visibleStart:!1,transitionEnd:!0})},a.handleCanvasMouseDown=function(e){a.props.onMaskClick(e)},a.getActiveImage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t={src:"",alt:"",downloadUrl:""},n=a.props.images||[],o=null;return o=void 0!==e?e:a.state.activeIndex,n.length>0&&o>=0&&(t=n[o]),t},a.handleMouseScroll=function(e){if(!a.props.disableMouseZoom){e.preventDefault();var t=0,n=e.deltaY;if(t=0===n?0:n>0?-1:1,0!==t){var o=e.clientX,i=e.clientY;if(a.props.container){var r=a.props.container.getBoundingClientRect();o-=r.left,i-=r.top}a.handleScrollZoom(o,i,t)}}},a.prefixCls="react-viewer",a.state={visible:!1,visibleStart:!1,transitionEnd:!1,activeIndex:a.props.activeIndex,width:0,height:0,top:15,left:null,rotate:0,imageWidth:0,imageHeight:0,scaleX:a.props.defaultScale,scaleY:a.props.defaultScale,loading:!1,loadFailed:!1},a.setContainerWidthHeight(),a.footerHeight=m.FOOTER_HEIGHT,a}return I(t,e),t.prototype.setContainerWidthHeight=function(){this.containerWidth=window.innerWidth,this.containerHeight=window.innerHeight,this.props.container&&(this.containerWidth=this.props.container.offsetWidth,this.containerHeight=this.props.container.offsetHeight,this.setInlineContainerHeight())},t.prototype.setInlineContainerHeight=function(){var e=this.refs["viewerCore"];e&&(this.containerHeight=e.offsetHeight)},t.prototype.startVisible=function(e){var t=this;this.props.container||(document.body.style.overflow="hidden",document.body.scrollHeight>document.body.clientHeight&&(document.body.style.paddingRight="15px")),this.setState({visibleStart:!0}),setTimeout(function(){t.setState({visible:!0,activeIndex:e}),setTimeout(function(){t.bindEvent(),t.loadImg(e)},300)},10)},t.prototype.componentDidMount=function(){var e=this.refs["viewerCore"];e.addEventListener("transitionend",this.handleTransitionEnd,!1),this.refs["viewerCore"].addEventListener("wheel",this.handleMouseScroll,!1),0===this.containerHeight&&this.setInlineContainerHeight(),this.startVisible(this.state.activeIndex)},t.prototype.getImgWidthHeight=function(e,t){var n=0,o=0,a=.8*this.containerWidth,i=.8*(this.containerHeight-this.footerHeight);return n=Math.min(a,e),o=n/e*t,o>i&&(o=i,n=o/t*e),this.props.noLimitInitializationSize&&(n=e,o=t),[n,o]},t.prototype.loadImg=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=null,a=this.props.images||[];a.length>0&&(o=a[e]);var i=!1,r=new Image;this.setState({activeIndex:e,loading:!0,loadFailed:!1},function(){r.onload=function(){i||t.loadImgSuccess(o,r.width,r.height,n)},r.onerror=function(){if(t.props.defaultImg){t.setState({loadFailed:!0});var a=t.props.defaultImg.width||.5*t.containerWidth,i=t.props.defaultImg.height||.5*t.containerHeight;t.loadImgSuccess(o,a,i,n)}else t.setState({activeIndex:e,imageWidth:0,imageHeight:0,loading:!1})},r.src=o.src,r.complete&&(i=!0,t.loadImgSuccess(o,r.width,r.height,n))})},t.prototype.bindEvent=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="addEventListener";e&&(t="removeEventListener"),this.props.disableKeyboardSupport||document[t]("keydown",this.handleKeydown,!0)},t.prototype.componentWillUnmount=function(){this.bindEvent(!0),this.refs["viewerCore"].removeEventListener("transitionend",this.handleTransitionEnd,!1)},t.prototype.componentDidUpdate=function(e){var t=this;if(!this.props.visible||e.visible)return!this.props.visible&&e.visible?(this.bindEvent(!0),this.handleZoom(this.containerWidth/2,(this.containerHeight-this.footerHeight)/2,-1,(this.state.scaleX>0?1:-1)*this.state.scaleX-.11),void setTimeout(function(){document.body.style.overflow="",document.body.style.paddingRight="",t.setState({visible:!1,transitionEnd:!1,width:0,height:0,scaleX:t.props.defaultScale,scaleY:t.props.defaultScale,rotate:1,imageWidth:0,imageHeight:0,loadFailed:!1})},k)):void(this.props.activeIndex===e.activeIndex||this.handleChangeImg(this.props.activeIndex));this.startVisible(this.props.activeIndex)},t.prototype.render=function(){var e,t={src:"",alt:""},n=1e3;this.props.zIndex&&(n=this.props.zIndex);var o={opacity:this.state.visible?1:0};!this.state.visible&&this.state.transitionEnd&&(o.display="none"),!this.state.visible&&this.state.visibleStart&&(o.display="block"),this.state.visible&&this.state.transitionEnd&&(t=this.getActiveImage());var a=(0,b.default)(""+this.prefixCls,this.prefixCls+"-transition",(e={},O(e,this.prefixCls+"-inline",this.props.container),O(e,this.props.className,this.props.className),e));return i.createElement("div",{ref:"viewerCore",className:a,style:o},i.createElement("div",{className:this.prefixCls+"-mask",style:{zIndex:n}}),this.props.noClose||i.createElement("div",{className:this.prefixCls+"-close "+this.prefixCls+"-btn",onClick:this.handleClose,style:{zIndex:n+10}},i.createElement(f.default,{type:d.ActionType.close})),i.createElement(s.default,{prefixCls:this.prefixCls,imgSrc:this.state.loadFailed&&this.props.defaultImg.src||t.src,visible:this.props.visible,width:this.state.width,height:this.state.height,top:this.state.top,left:this.state.left,rotate:this.state.rotate,onChangeImgState:this.handleChangeImgState,onResize:this.handleResize,zIndex:n+5,scaleX:this.state.scaleX,scaleY:this.state.scaleY,loading:this.state.loading,drag:this.props.drag,container:this.props.container,onCanvasMouseDown:this.handleCanvasMouseDown}),this.props.noFooter||i.createElement("div",{className:this.prefixCls+"-footer",style:{zIndex:n+5}},this.props.noToolbar||i.createElement(u.default,{prefixCls:this.prefixCls,onAction:this.handleAction,alt:t.alt,width:this.state.imageWidth,height:this.state.imageHeight,attribute:this.props.attribute,zoomable:this.props.zoomable,rotatable:this.props.rotatable,scalable:this.props.scalable,changeable:this.props.changeable,downloadable:this.props.downloadable,noImgDetails:this.props.noImgDetails,toolbars:this.props.customToolbar(p.defaultToolbars)}),this.props.noNavbar||i.createElement(l.default,{prefixCls:this.prefixCls,images:this.props.images,activeIndex:this.state.activeIndex,onChangeImg:this.handleChangeImg})))},t}(i.Component);t.default=E,E.defaultProps={visible:!1,onClose:C,images:[],activeIndex:0,zIndex:1e3,drag:!0,attribute:!0,zoomable:!0,rotatable:!0,scalable:!0,onMaskClick:C,changeable:!0,customToolbar:function(e){return e},zoomSpeed:.05,disableKeyboardSupport:!1,noResetZoomAfterChange:!1,noLimitInitializationSize:!1,defaultScale:1,loop:!0,disableMouseZoom:!1},e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(1),a=i(o);function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var a=n[o],i=Object.getOwnPropertyDescriptor(t,a);i&&i.configurable&&void 0===e[a]&&Object.defineProperty(e,a,i)}return e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):r(e,t))}var p=function(e){function t(){s(this,t);var n=c(this,e.apply(this,arguments));return n.handleChangeImg=function(e){n.props.activeIndex!==e&&n.props.onChangeImg(e)},n}return l(t,e),t.prototype.render=function(){var e=this,t="calc(50% - "+(this.props.activeIndex+1)+" * 31px)",n={marginLeft:t};return a.createElement("div",{className:this.props.prefixCls+"-navbar"},a.createElement("ul",{className:this.props.prefixCls+"-list "+this.props.prefixCls+"-list-transition",style:n},this.props.images.map(function(t,n){return a.createElement("li",{key:n,className:n===e.props.activeIndex?"active":"",onClick:function(){e.handleChangeImg(n)}},a.createElement("img",{src:t.src,alt:t.alt}))})))},t}(a.Component);t.default=p,p.defaultProps={activeIndex:0},e.exports=t["default"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.defaultToolbars=void 0;var o=n(1),a=c(o),i=n(2),r=s(i);function s(e){return e&&e.__esModule?e:{default:e}}function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function l(e,t){for(var n=Object.getOwnPropertyNames(t),o=0;o<n.length;o++){var a=n[o],i=Object.getOwnPropertyDescriptor(t,a);i&&i.configurable&&void 0===e[a]&&Object.defineProperty(e,a,i)}return e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function d(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):l(e,t))}t.defaultToolbars=[{key:"zoomIn",actionType:i.ActionType.zoomIn},{key:"zoomOut",actionType:i.ActionType.zoomOut},{key:"prev",actionType:i.ActionType.prev},{key:"reset",actionType:i.ActionType.reset},{key:"next",actionType:i.ActionType.next},{key:"rotateLeft",actionType:i.ActionType.rotateLeft},{key:"rotateRight",actionType:i.ActionType.rotateRight},{key:"scaleX",actionType:i.ActionType.scaleX},{key:"scaleY",actionType:i.ActionType.scaleY},{key:"download",actionType:i.ActionType.download}];function f(e,t){var n=e.filter(function(e){return t.indexOf(e.key)<0});return n}var h=function(e){function t(){p(this,t);var n=u(this,e.call(this));return n.renderAction=function(e){var t=null;return"undefined"!==typeof i.ActionType[e.actionType]&&(t=a.createElement(r.default,{type:e.actionType})),e.render&&(t=e.render),a.createElement("li",{key:e.key,className:n.props.prefixCls+"-btn",onClick:function(){n.handleAction(e)},"data-key":e.key},t)},n}return d(t,e),t.prototype.handleAction=function(e){this.props.onAction(e)},t.prototype.render=function(){var e=this,t=this.props.attribute?a.createElement("p",{className:this.props.prefixCls+"-attribute"},this.props.alt&&""+this.props.alt,this.props.noImgDetails||a.createElement("span",{className:this.props.prefixCls+"-img-details"},"("+this.props.width+" x "+this.props.height+")")):null,n=this.props.toolbars;return this.props.zoomable||(n=f(n,["zoomIn","zoomOut"])),this.props.changeable||(n=f(n,["prev","next"])),this.props.rotatable||(n=f(n,["rotateLeft","rotateRight"])),this.props.scalable||(n=f(n,["scaleX","scaleY"])),this.props.downloadable||(n=f(n,["download"])),a.createElement("div",null,t,a.createElement("ul",{className:this.props.prefixCls+"-toolbar"},n.map(function(t){return e.renderAction(t)})))},t}(a.Component);t.default=h},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=84;t.FOOTER_HEIGHT=n},function(e,t){},function(e,n){e.exports=t}])})},function(e,t,n){e.exports=n(0)(19)},function(e,t,n){e.exports={"react-viewer":"react-viewer","react-viewer-inline":"react-viewer-inline","react-viewer-mask":"react-viewer-mask","react-viewer-btn":"react-viewer-btn","react-viewer-close":"react-viewer-close","react-viewer-canvas":"react-viewer-canvas",drag:"drag","react-viewer-footer":"react-viewer-footer","react-viewer-attribute":"react-viewer-attribute","react-viewer-toolbar":"react-viewer-toolbar",empty:"empty","react-viewer-navbar":"react-viewer-navbar","react-viewer-list":"react-viewer-list",active:"active","react-viewer-transition":"react-viewer-transition","react-viewer-image-transition":"react-viewer-image-transition","react-viewer-list-transition":"react-viewer-list-transition","react-viewer-icon":"react-viewer-icon","react-viewer-icon-zoomIn":"react-viewer-icon-zoomIn","react-viewer-icon-zoomOut":"react-viewer-icon-zoomOut","react-viewer-icon-prev":"react-viewer-icon-prev","react-viewer-icon-next":"react-viewer-icon-next","react-viewer-icon-close":"react-viewer-icon-close","react-viewer-icon-rotateLeft":"react-viewer-icon-rotateLeft","react-viewer-icon-rotateRight":"react-viewer-icon-rotateRight","react-viewer-icon-reset":"react-viewer-icon-reset","react-viewer-icon-scaleX":"react-viewer-icon-scaleX","react-viewer-icon-scaleY":"react-viewer-icon-scaleY","react-viewer-icon-download":"react-viewer-icon-download","circle-loading":"circle-loading",spin:"spin"}},,function(e,t,n){"use strict";var o="undefined"!==typeof self?self:"undefined"!==typeof window?window:void 0,a=o.AbortController,i=o.AbortSignal;e.exports=a,e.exports.AbortSignal=i,e.exports.default=a}])]);