(window["webpackJsonppackages_hzero_front_himp_name_"]=window["webpackJsonppackages_hzero_front_himp_name_"]||[]).push([[18],{100:function(t,e,n){t.exports=n(0)(604)},103:function(t,e,n){t.exports=n(58)(2662)},104:function(t,e,n){t.exports=n(0)(2092)},105:function(t,e,n){t.exports=n(0)(241)},106:function(t,e,n){t.exports=n(0)(151)},108:function(t,e,n){t.exports=n(0)(255)},109:function(t,e,n){t.exports=n(0)(1960)},110:function(t,e,n){t.exports=n(0)(298)},111:function(t,e,n){t.exports=n(58)(1367)},112:function(t,e,n){t.exports=n(0)(127)},113:function(t,e,n){t.exports=n(0)(484)},114:function(t,e,n){t.exports=n(0)(2129)},115:function(t,e,n){t.exports=n(0)(235)},116:function(t,e,n){t.exports=n(0)(209)},117:function(t,e,n){t.exports=n(0)(849)},118:function(t,e,n){t.exports=n(0)(328)},119:function(t,e,n){t.exports=n(0)(270)},120:function(t,e,n){t.exports=n(0)(170)},121:function(t,e,n){t.exports=n(0)(324)},122:function(t,e,n){t.exports=n(0)(386)},123:function(t,e,n){t.exports=n(0)(387)},124:function(t,e,n){t.exports=n(0)(868)},125:function(t,e,n){t.exports=n(0)(385)},126:function(t,e,n){t.exports=n(0)(156)},127:function(t,e,n){t.exports=n(0)(661)},128:function(t,e,n){t.exports=n(0)(1132)},129:function(t,e,n){t.exports=n(0)(580)},130:function(t,e,n){t.exports=n(0)(582)},131:function(t,e,n){t.exports=n(0)(128)},132:function(t,e,n){t.exports=n(0)(108)},133:function(t,e,n){t.exports=n(0)(472)},134:function(t,e,n){t.exports=n(0)(873)},135:function(t,e,n){t.exports=n(0)(2130)},136:function(t,e,n){t.exports=n(0)(1858)},137:function(t,e,n){t.exports=n(0)(3)},148:function(t,e,n){t.exports=n(58)(2663)},156:function(t,e,n){t.exports=n(0)(813)},157:function(t,e,n){t.exports=n(0)(901)},158:function(t,e,n){t.exports=n(0)(1205)},159:function(t,e,n){t.exports=n(0)(1204)},160:function(t,e,n){t.exports=n(0)(382)},226:function(t,e,n){t.exports=n(0)(2227)},227:function(t,e,n){t.exports=n(0)(2224)},228:function(t,e,n){t.exports=n(0)(1258)},28:function(t,e,n){"use strict";n.r(e);n(236);var o=n(226),r=n.n(o),a=(n(254),n(227)),c=n.n(a),i=(n(243),n(374)),s=n.n(i),p=n(179),u=n(9),l=(n(255),n(228)),d=n.n(l),m=n(65),f=n(66),h=n(68),x=n(67),b=n(69),v=n(73),g=n(1),y=n.n(g),O=n(72),j=n(137),w=n.n(j),_=n(168),E=n(70),S=n(62),k=n(151),C=n(61),T=n(148),P=n.n(T),D=n(2),A=n.n(D),R=n(10),U=n(63),F=Object(C["i"])();function M(t){return N.apply(this,arguments)}function N(){return N=Object(R["a"])(A.a.mark(function t(e){var n,o,r;return A.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.prefixPatch,o=e.code,r=n?"".concat(n,"/v1/").concat(F,"/import/template/").concat(o,"/info"):"".concat(S["e"],"/v1/").concat(F,"/template/").concat(o,"/info"),t.abrupt("return",Object(U["a"])(r,{method:"GET"}));case 3:case"end":return t.stop()}},t)})),N.apply(this,arguments)}var L,H,I=n(379),z=n.n(I);n.d(e,"default",function(){return q});var q=(L=Object(O["Bind"])(),H=function(t){function e(t){var n;Object(m["a"])(this,e),n=Object(h["a"])(this,Object(x["a"])(e).call(this,t));var o=t.location.search,r=void 0===o?"":o,a=P.a.parse(r),c=a.prefixPatch;return n.state={tableDS:null,prefixPatch:c,dynamicColumns:[]},n}return Object(b["a"])(e,t),Object(f["a"])(e,[{key:"componentDidMount",value:function(){var t=this.props.match,e=void 0===t?{}:t,n=e.params;n.templateCode&&this.getTemplate()}},{key:"getTemplate",value:function(){var t=this,e=this.props.match,n=void 0===e?{}:e,o=n.params,r=void 0===o?{}:o,a=this.state.prefixPatch,c=void 0===a?"":a;M({code:r.templateCode,prefixPatch:c}).then(function(e){var n=Object(C["n"])(e);if(n){var o=e.prefixPatch,r=void 0===o?"":o,a=e.templateType,i=e.templateTargetList,s=void 0===i?[]:i,l=s[0]||{},m=l.templateLineList,f=void 0===m?[]:m,h=f.map(function(t){return{name:t.columnCode,label:t.columnName,type:"Long"!==t.columnType?t.columnType:"Number",required:t.nullable}});t.setState({prefixPatch:r||c||("C"===a?"":S["e"]),dynamicColumns:f.map(function(t,e){return 0!==e?{name:t.columnCode}:{name:t.columnCode,width:16*t.columnName.length+64}}),formDS:new d.a({autoCreate:!0,autoQuery:!0,dataKey:"content",fields:[{name:"batch",type:"string",label:E["a"].get("himp.importHistory.view.title.importBatch").d("\u5bfc\u5165\u6279\u6b21\u53f7")},{name:"createdUserName",type:"string",label:E["a"].get("himp.importHistory.view.title.createUser").d("\u521b\u5efa\u4eba")},{name:"creationDate",type:"string",label:E["a"].get("himp.importHistory.view.title.createTime").d("\u521b\u5efa\u65f6\u95f4")}],transport:{read:function(e){var n=t.props.match.params.importId,o=void 0===n?0:n,r="".concat(t.state.prefixPatch,"/v1/").concat(Object(C["i"])(),"/import/manager/").concat(o);return Object(u["a"])({},e,{url:r,method:"GET"})}}}),tableDS:new d.a({autoQuery:!0,selection:!1,dataKey:"content",fields:[].concat(Object(p["a"])(h),[{name:"_dataStatus",type:"string",label:E["a"].get("himp.comment.model.comment.dataStatus").d("\u6570\u636e\u72b6\u6001")},{name:"_errorMsg",type:"string",label:E["a"].get("himp.comment.model.comment.errorMsg").d("\u9519\u8bef\u4fe1\u606f")}]),transport:{read:function(e){var n=t.props.match.params,o=n.templateCode,r=void 0===o?"":o,a=n.batch,c=void 0===a?"":a,i="".concat(t.state.prefixPatch,"/v1/").concat(Object(C["i"])(),"/import/data?templateCode=").concat(r,"&batch=").concat(c);return Object(u["a"])({},e,{url:i,method:"GET",transformResponse:function(t){var e=JSON.parse(t);return 0===e.content.length?e:(e=e.content.map(function(t){var e=t._batch,n=void 0===e?"":e,o=t._dataStatus,r=void 0===o?"":o,a=t._dataStatusMeaning,c=void 0===a?"":a,i=t._id,s=void 0===i?"":i,p=t._templateCode,l=void 0===p?"":p,d=t._errorMsg,m=void 0===d?"":d;return Object(u["a"])({_batch:n},JSON.parse(t._data),{_dataStatus:r,_dataStatusMeaning:c,_id:s,_templateCode:l,_errorMsg:m})}),e)}})}}})})}})}},{key:"render",value:function(){var t=this.state,e=t.formDS,n=t.tableDS;return y.a.createElement(y.a.Fragment,null,y.a.createElement(_["b"],{title:E["a"].get("himp.importHistory.view.message.historyDetail").d("\u5386\u53f2\u8be6\u60c5"),backPath:"/himp/history/list"}),y.a.createElement(_["a"],null,y.a.createElement("div",{className:w()(z.a["label-col"])},E["a"].get("himp.importHistory.view.message.importHistory").d("\u5bfc\u5165\u5386\u53f2")),y.a.createElement(c.a,{dataSet:e,columns:3},y.a.createElement(s.a,{name:"batch"}),y.a.createElement(s.a,{name:"createdUserName"}),y.a.createElement(s.a,{name:"creationDate"})),y.a.createElement("div",{className:w()(z.a["label-col"]),style:{marginBottom:20}},E["a"].get("himp.importHistory.view.message.detailData").d("\u6570\u636e\u8be6\u60c5")),null!==n?y.a.createElement(r.a,{dataSet:n,columns:this.columns,queryBar:"normal"}):null))}},{key:"columns",get:function(){return[].concat(Object(p["a"])(this.state.dynamicColumns),[{name:"_dataStatus",renderer:function(t){var e=t.record,n=e.data._dataStatusMeaning,o=void 0===n?"":n,r=[{status:"NEW",color:"blue"},{status:"VALID_SUCCESS",color:"green"},{status:"VALID_FAILED",color:"red"},{status:"IMPORT_SUCCESS",color:"green"},{status:"IMPORT_FAILED",color:"red"},{status:"ERROR",color:"red"}],a=r.find(function(e){return e.status===t.value})||{};return Object(k["a"])(t.value,[{status:a.status,text:o,color:a.color}])}},{name:"_errorMsg",width:200}])}}]),e}(y.a.Component),Object(v["a"])(H.prototype,"getTemplate",[L],Object.getOwnPropertyDescriptor(H.prototype,"getTemplate"),H.prototype),H)},374:function(t,e,n){t.exports=n(0)(2336)},379:function(t,e,n){t.exports={"label-col":"himp-routes-import-history-detail-label-col"}},63:function(t,e,n){"use strict";n.d(e,"a",function(){return v});var o=n(2),r=n.n(o),a=n(9),c=n(10),i=(n(138),n(75)),s=n(136),p=n.n(s),u=n(74),l=n(70),d=n(62),m=n(61);function f(t){if(t.status>=200&&t.status<300)return t;var e=t.statusText,n=new Error(e);throw n.name=t.status,n.response=t,n}function h(t){return x.apply(this,arguments)}function x(){return x=Object(c["a"])(r.a.mark(function t(e){var n;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(501!==e.name){t.next=14;break}return t.prev=1,t.next=4,e.response.json();case 4:n=t.sent,dvaApp._store.dispatch({type:"error/updateState",payload:{normal501:n}}),dvaApp._store.dispatch(u["routerRedux"].push({pathname:"/exception/501"})),t.next=12;break;case 9:throw t.prev=9,t.t0=t["catch"](1),e;case 12:t.next=15;break;case 14:throw e;case 15:case"end":return t.stop()}},t,null,[[1,9]])})),x.apply(this,arguments)}i["default"].config({placement:"bottomRight"});var b={Pragma:"no-cache","Cache-Control":"no-cache"};function v(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o={credentials:"include",headers:b},r=n.beforeCatch,c=t.startsWith("/api")||t.startsWith("http")?t:"".concat(d["a"]).concat(t),s=Object(a["a"])({},o,e);if("POST"!==s.method&&"PUT"!==s.method&&"DELETE"!==s.method&&"PATCH"!==s.method||(s.body instanceof FormData?s.headers=Object(a["a"])({Accept:"application/json"},s.headers):(s.headers=Object(a["a"])({Accept:"application/json","Content-Type":"application/json; charset=utf-8"},s.headers),s.body=JSON.stringify(s.body))),s.query){var x=s.query;"GET"===s.method&&(x=Object(m["d"])(s.query)),c=Object(m["e"])(c,x)}var g=Object(m["f"])();g&&(s.headers=Object(a["a"])({},s.headers,{Authorization:"bearer ".concat(g)}));var y=p()(c,s).then(f).then(function(t){return 204===t.status?{}:"blob"===s.responseType?t.blob():"text"===s.responseType?t.text():t.json()});return r&&(y=y.catch(r)),y=y.catch(h).catch(function(t){var e=t.name,n=Object(m["p"])("isErrorFlag");if(n||Object(m["w"])("isErrorFlag",!1),401===e){var o=encodeURIComponent(window.location.toString());return g?void v("".concat(d["h"],"/public/token/kickoff"),{method:"POST",query:{access_token:g}}).then(function(t){1===t.kickoff?(dvaApp._store.dispatch(u["routerRedux"].push({pathname:"/public/kickoff"})),Object(m["w"])("redirectUrl",o),Object(m["w"])("isErrorFlag",!1)):(dvaApp._store.dispatch(u["routerRedux"].push({pathname:"/public/unauthorized"})),Object(m["w"])("isErrorFlag",!0),Object(m["w"])("redirectUrl",o))}):(Object(m["u"])(),Object(m["v"])(),-1!==c.indexOf(d["b"])?void(d["k"].includes("?")?(window.location.href="".concat(d["k"],"&redirect_uri=").concat(o),Object(m["w"])("isErrorFlag",!1),Object(m["w"])("redirectUrl",o)):(window.location.href="".concat(d["k"],"?redirect_uri=").concat(o),m["w"].apply("isErrorFlag",!1),Object(m["w"])("redirectUrl",o))):void(n||(dvaApp._store.dispatch(u["routerRedux"].push({pathname:"/public/unauthorized"})),Object(m["w"])("isErrorFlag",!0),Object(m["w"])("redirectUrl",o))))}if(-1!==c.indexOf(d["b"]))return t;"TypeError"!==e?i["default"].error({message:"".concat(e),description:t.message}):i["default"].error({message:l["a"].get("hzero.common.notification.network.typeError").d("\u7f51\u7edc\u8bf7\u6c42\u5f02\u5e38"),description:l["a"].get("hzero.common.notification.typeError.description").d("\u8bf7\u7a0d\u540e\u91cd\u8bd5")})}),y}},64:function(t,e,n){t.exports=n(0)(198)},71:function(t,e,n){t.exports=n(0)(1169)},72:function(t,e,n){t.exports=n(58)(2563)},74:function(t,e,n){t.exports=n(0)(1852)},75:function(t,e,n){t.exports=n(0)(1155)},78:function(t,e,n){t.exports=n(0)(82)},79:function(t,e,n){t.exports=n(0)(116)},80:function(t,e,n){t.exports=n(0)(1168)},81:function(t,e,n){t.exports=n(0)(37)},82:function(t,e,n){t.exports=n(0)(829)},83:function(t,e,n){t.exports=n(0)(1167)},85:function(t,e,n){t.exports=n(0)(34)},88:function(t,e,n){t.exports=n(0)(182)},90:function(t,e,n){t.exports=n(0)(130)},91:function(t,e,n){t.exports=n(0)(1154)},93:function(t,e,n){t.exports=n(0)(274)},94:function(t,e,n){t.exports=n(58)(2648)},99:function(t,e,n){t.exports=n(0)(325)}}]);